{"version":3,"sources":["webpack:///./node_modules/@ecomplus/widget-search-engine/src/index.js","webpack:///./node_modules/@linusborg/vue-simple-portal/dist/index.esm.js","webpack:///./node_modules/nanoid/non-secure/index.js"],"names":["options","elId","$searchEngine","document","getElementById","$dock","$productItems","getScopedSlots","window","storefront","urlParams","URLSearchParams","location","search","props","term","get","page","parseInt","brands","getAll","categories","defaultFilters","reduce","filters","gridAndOption","gridId","option","split","push","sort","dataset","defaultSort","forEach","resource","JSON","parse","err","console","error","length","charAt","toUpperCase","slice","hasPopularItems","body","Error","vueApp","Vue","data","countRequests","canShowItems","render","createElement","vm","this","on","fetch","fetching","then","result","renderNewItems","$","remove","hits","isSameItems","i","find","_id","SearchEngine","attrs","id","loadMoreSelector","scopedSlots","undefined","append","mount","$mount","observer","MutationObserver","clearTimeout","fallbackTimer","disconnect","setTimeout","observe","childList","_typeof","obj","Symbol","iterator","constructor","prototype","config","selector","concat","size","Math","random","nanoid","setSelector","isBrowser","TargetContainer","extend","abstract","name","updatedNodes","nodes","h","text","tag","destroyed","el","$el","parentNode","removeChild","Portal","disabled","type","Boolean","prepend","String","default","$scopedSlots","created","getTargetEl","insertTargetEl","updated","_this","$nextTick","slotFn","container","beforeDestroy","unmount","watch","immediate","handler","methods","querySelector","parent","child","substring","appendChild","targetEl","firstChild","insertBefore","propsData","$destroy","install","_Vue","arguments","component","defaultSelector","use"],"mappings":";qIAUe,WAACA,EAAU,GAAIC,EAAO,mBACnC,MAAMC,EAAgBC,SAASC,eAAeH,GAC9C,GAAIC,EAAe,CACjB,MAAMG,EAAQF,SAASC,eAAgB,GAAEH,UACzC,IAAIK,EACJ,MAAMC,EAAiBC,OAAOC,YAAcD,OAAOC,WAAWF,eAExDG,EAAY,IAAIC,gBAAgBH,OAAOI,SAASC,QAChDC,EAAQ,IACTd,EAAQc,MACXC,KAAML,EAAUM,IAAI,QACpBC,KAAMC,SAASR,EAAUM,IAAI,QAAS,KAAO,EAC7CG,OAAQT,EAAUU,OAAO,YACzBC,WAAYX,EAAUU,OAAO,gBAC7BE,eAAgBZ,EAAUU,OAAO,aAAaG,QAAO,CAACC,EAASC,KAC7D,MAAOC,EAAQC,GAAUF,EAAcG,MAAM,KAK7C,OAJKJ,EAAQE,KACXF,EAAQE,GAAU,IAEpBF,EAAQE,GAAQG,KAAKF,GACdH,IACN,MAEC,KAAEM,GAAS5B,EAAc6B,QAC3BD,IACFhB,EAAMkB,YAAcF,GAGrB,CAAC,SAAU,cAAcG,SAAQC,IAChC,GAAIhC,EAAc6B,QAAQG,GAAW,CACnC,IACEpB,EAAMoB,GAAYC,KAAKC,MAAMlC,EAAc6B,QAAQG,IACnD,MAAOG,GAEP,YADAC,QAAQC,MAAMF,GAGZvB,EAAMoB,IAAapB,EAAMoB,GAAUM,OAAS,IAC9C1B,EAAO,UAASoB,EAASO,OAAO,GAAGC,gBAAgBR,EAASS,MAAM,OAAQ,GAE5E7B,EAAM8B,iBAAkB,MAI5B,MAAM,SAAEV,GAAa1B,OAAOL,SAAS0C,KAAKd,QAC1C,OAAQG,GACN,IAAK,SACL,IAAK,aACH,IAAKpB,EAAMoB,KAAcpB,EAAMoB,GAAUM,OAEvC,YADAF,QAAQC,MAAM,IAAIO,MAAO,qCAAoCZ,cAKnE,MAAMa,EAAS,IAAIC,IAAI,CACrBC,KAAM,CACJC,cAAe,EACfC,cAAe9C,EACfU,KAAMD,EAAMC,MAGdqC,OAAQC,GACN,MAAMC,EAAKC,KACLC,EAAK,CACT,cAAezC,GACbuC,EAAGvC,KAAOA,IAqCd,OAjCIV,IACFmD,EAAGC,MAAQ,UAAU,SAAEC,IACrBA,EAASC,MAAKC,IACZN,EAAGJ,gBACH,MAAMW,EAAiB,KACrBP,EAAGH,cAAe,EAClBW,YAAE,uBAAuBC,UAE3B,IAAKT,EAAGH,aACN,GAAIG,EAAGJ,cAAgB,EACrBW,SACK,GAAID,GAAUA,EAAOI,KAC1B,GAAK1D,GAAiBA,EAAckC,SAAWoB,EAAOI,KAAKA,KAAKxB,OAEzD,CACL,IAAIyB,GAAc,EAClB,MAAM,KAAED,GAASJ,EAAOI,KACxB,IAAK,IAAIE,EAAI,EAAGA,EAAIF,EAAKxB,OAAQ0B,IAC/B,IAAK5D,EAAc6D,KAAM,qBAAoBH,EAAKE,GAAGE,SAAS5B,OAAQ,CACpEyB,GAAc,EACd,MAGCA,GACHJ,SAXFA,SAoBLR,EAAcgB,IAAc,CACjCC,MAAO,CACLC,GAAIlE,EAAQ,KAAOJ,GAErBa,MAAO,IACFA,EACHC,KAAMuC,EAAGvC,KACToC,aAAcG,EAAGH,aACjBqB,iBAAkBnE,EAAQ,sBAAwB,MAEpDmD,KACAiB,YAAuC,mBAAnBlE,EAChBA,EAAeL,EAAemD,GAAgBhD,QAC9CqE,OAKV,GAAIrE,EAAO,CACTyD,YAAE5D,GAAeyE,OAAOb,YAAE,QAAS,CACjCS,GAAI,wBAGN,MAAMK,EAAQ,IAAM7B,EAAO8B,OAAOxE,GAElC,GADAC,EAAgBwD,YAAE,qCACdxD,EAAckC,OAAQ,CACxB,MAAMsC,EAAW,IAAItE,OAAOuE,kBAAiB,KAC3CC,aAAaC,GACbH,EAASI,aACTC,WAAWP,EAAO,QAEpBE,EAASM,QAAQ9E,EAAc,GAAI,CACjC+E,WAAW,IAEb,MAAMJ,EAAgBE,YAAW,KAC/BL,EAASI,aACTN,MACC,UAEHA,SAGF7B,EAAO8B,OAAO3E,M,+EC9IpB,SAASoF,EAAQC,GAaf,OATED,EADoB,mBAAXE,QAAoD,iBAApBA,OAAOC,SACtC,SAAUF,GAClB,cAAcA,GAGN,SAAUA,GAClB,OAAOA,GAAyB,mBAAXC,QAAyBD,EAAIG,cAAgBF,QAAUD,IAAQC,OAAOG,UAAY,gBAAkBJ,IAI9GA,GAGjB,IAAIK,EAAS,CACXC,SAAU,qBAAqBC,OCVpB,EAACC,EAAO,MACnB,IAAIxB,EAAK,GAELL,EAAI6B,EACR,KAAO7B,KAELK,GArBF,mEAqBqC,GAAhByB,KAAKC,SAAiB,GAE3C,OAAO1B,GDE+B2B,KAEpCC,EAAc,SAAqBN,GACrC,OAAOD,EAAOC,SAAWA,GAEvBO,EAA8B,oBAAX5F,aAAkGkE,KAAnD,oBAAbvE,SAA2B,YAAcmF,EAAQnF,WAEtGkG,EAAkB,IAAIC,OAAO,CAM/BC,UAAU,EACVC,KAAM,eACN1F,MAAO,CAAC,QAAS,OACjBmC,KAAM,SAAcK,GAClB,MAAO,CACLmD,aAAcnD,EAAGoD,QAGrBtD,OAAQ,SAAgBuD,GACtB,IAAID,EAAQnD,KAAKkD,cAAgBlD,KAAKkD,eACtC,OAAKC,EACmB,IAAjBA,EAAMlE,QAAiBkE,EAAM,GAAGE,KAAeD,EAAEpD,KAAKsD,KAAO,MAAOH,GAA7BA,EAD3BC,KAGrBG,UAAW,WACT,IAAIC,EAAKxD,KAAKyD,IACdD,GAAMA,EAAGE,WAAWC,YAAYH,MAIhCI,EAAS,IAAIb,OAAO,CACtBE,KAAM,kBACN1F,MAAO,CACLsG,SAAU,CACRC,KAAMC,SAERC,QAAS,CACPF,KAAMC,SAERzB,SAAU,CACRwB,KAAMG,OACNC,QAAS,WACP,MAAO,IAAI3B,OAAOF,EAAOC,YAG7BgB,IAAK,CACHQ,KAAMG,OACNC,QAAS,QAGbrE,OAAQ,SAAgBuD,GACtB,GAAIpD,KAAK6D,SAAU,CACjB,IAAIV,EAAQnD,KAAKmE,cAAgBnE,KAAKmE,aAAaD,UACnD,OAAKf,EACEA,EAAMlE,OAAS,IAAMkE,EAAM,GAAGE,KAAOF,EAAQC,EAAEpD,KAAKsD,IAAKH,GAD7CC,IAIrB,OAAOA,KAETgB,QAAS,WACFpE,KAAKqE,eACRrE,KAAKsE,kBAGTC,QAAS,WACP,IAAIC,EAAQxE,KAMZA,KAAKyE,WAAU,WACRD,EAAMX,UAAYW,EAAME,SAAWF,EAAML,aAAaD,UACzDM,EAAMG,UAAUzB,aAAesB,EAAML,aAAaD,SAGpDM,EAAME,OAASF,EAAML,aAAaD,YAGtCU,cAAe,WACb5E,KAAK6E,WAEPC,MAAO,CACLjB,SAAU,CACRkB,WAAW,EACXC,QAAS,SAAiBnB,GACxBA,EAAW7D,KAAK6E,UAAY7E,KAAKyE,UAAUzE,KAAKqB,UAItD4D,QAAS,CAEPZ,YAAa,WACX,GAAKxB,EACL,OAAOjG,SAASsI,cAAclF,KAAKsC,WAErCgC,eAAgB,WACd,GAAKzB,EAAL,CACA,IAAIsC,EAASvI,SAASsI,cAAc,QAChCE,EAAQxI,SAASkD,cAAcE,KAAKsD,KACxC8B,EAAMpE,GAAKhB,KAAKsC,SAAS+C,UAAU,GACnCF,EAAOG,YAAYF,KAErB/D,MAAO,WACL,GAAKwB,EAAL,CACA,IAAI0C,EAAWvF,KAAKqE,cAChBb,EAAK5G,SAASkD,cAAc,OAE5BE,KAAKgE,SAAWuB,EAASC,WAC3BD,EAASE,aAAajC,EAAI+B,EAASC,YAEnCD,EAASD,YAAY9B,GAGvBxD,KAAK2E,UAAY,IAAI7B,EAAgB,CACnCU,GAAIA,EACJ2B,OAAQnF,KACR0F,UAAW,CACTpC,IAAKtD,KAAKsD,IACVH,MAAOnD,KAAKmE,aAAaD,aAI/BW,QAAS,WACH7E,KAAK2E,YACP3E,KAAK2E,UAAUgB,kBACR3F,KAAK2E,eAMpB,SAASiB,EAAQC,GACf,IAAIpJ,EAAUqJ,UAAU7G,OAAS,QAAsBkC,IAAjB2E,UAAU,GAAmBA,UAAU,GAAK,GAElFD,EAAKE,UAAUtJ,EAAQwG,MAAQ,SAAUW,GAErCnH,EAAQuJ,iBACVpD,EAAYnG,EAAQuJ,iBAIF,oBAAX/I,QAA0BA,OAAOwC,KAAOxC,OAAOwC,MAAQ,KAEhE,IAAIwG,IAAIL","file":"chunk.e1e02e20277cb06f7ac5.js","sourcesContent":["/*!\n * @ecomplus/widget-search-engine\n * (c) E-Com Club <ti@e-com.club>\n * Released under the MIT License.\n */\n\nimport { $ } from '@ecomplus/storefront-twbs'\nimport Vue from 'vue'\nimport SearchEngine from '#components/SearchEngine.vue'\n\nexport default (options = {}, elId = 'search-engine') => {\n  const $searchEngine = document.getElementById(elId)\n  if ($searchEngine) {\n    const $dock = document.getElementById(`${elId}-dock`)\n    let $productItems\n    const getScopedSlots = window.storefront && window.storefront.getScopedSlots\n\n    const urlParams = new URLSearchParams(window.location.search)\n    const props = {\n      ...options.props,\n      term: urlParams.get('term'),\n      page: parseInt(urlParams.get('page'), 10) || 1,\n      brands: urlParams.getAll('brands[]'),\n      categories: urlParams.getAll('categories[]'),\n      defaultFilters: urlParams.getAll('filters[]').reduce((filters, gridAndOption) => {\n        const [gridId, option] = gridAndOption.split(':')\n        if (!filters[gridId]) {\n          filters[gridId] = []\n        }\n        filters[gridId].push(option)\n        return filters\n      }, {})\n    }\n    const { sort } = $searchEngine.dataset\n    if (sort) {\n      props.defaultSort = sort\n    }\n\n    ;['brands', 'categories'].forEach(resource => {\n      if ($searchEngine.dataset[resource]) {\n        try {\n          props[resource] = JSON.parse($searchEngine.dataset[resource])\n        } catch (err) {\n          console.error(err)\n          return\n        }\n        if (props[resource] && props[resource].length < 2) {\n          props[`isFixed${resource.charAt(0).toUpperCase()}${resource.slice(1)}`] = true\n        }\n        props.hasPopularItems = false\n      }\n    })\n\n    const { resource } = window.document.body.dataset\n    switch (resource) {\n      case 'brands':\n      case 'categories':\n        if (!props[resource] || !props[resource].length) {\n          console.error(new Error(`Skipping SearchEngine with empty '${resource}' filter`))\n          return\n        }\n    }\n\n    const vueApp = new Vue({\n      data: {\n        countRequests: 0,\n        canShowItems: !$dock,\n        term: props.term\n      },\n\n      render (createElement) {\n        const vm = this\n        const on = {\n          'update:term' (term) {\n            vm.term = term\n          }\n        }\n\n        if ($dock) {\n          on.fetch = function ({ fetching }) {\n            fetching.then(result => {\n              vm.countRequests++\n              const renderNewItems = () => {\n                vm.canShowItems = true\n                $('#search-engine-snap').remove()\n              }\n              if (!vm.canShowItems) {\n                if (vm.countRequests > 1) {\n                  renderNewItems()\n                } else if (result && result.hits) {\n                  if (!$productItems || $productItems.length !== result.hits.hits.length) {\n                    renderNewItems()\n                  } else {\n                    let isSameItems = true\n                    const { hits } = result.hits\n                    for (let i = 0; i < hits.length; i++) {\n                      if (!$productItems.find(`[data-product-id=\"${hits[i]._id}\"]`).length) {\n                        isSameItems = false\n                        break\n                      }\n                    }\n                    if (!isSameItems) {\n                      renderNewItems()\n                    }\n                  }\n                }\n              }\n            })\n          }\n        }\n\n        return createElement(SearchEngine, {\n          attrs: {\n            id: $dock ? null : elId\n          },\n          props: {\n            ...props,\n            term: vm.term,\n            canShowItems: vm.canShowItems,\n            loadMoreSelector: $dock ? '#search-engine-load' : null\n          },\n          on,\n          scopedSlots: typeof getScopedSlots === 'function'\n            ? getScopedSlots($searchEngine, createElement, !$dock)\n            : undefined\n        })\n      }\n    })\n\n    if ($dock) {\n      $($searchEngine).append($('<div>', {\n        id: 'search-engine-load'\n      }))\n\n      const mount = () => vueApp.$mount($dock)\n      $productItems = $('#search-engine-snap .product-item')\n      if ($productItems.length) {\n        const observer = new window.MutationObserver(() => {\n          clearTimeout(fallbackTimer)\n          observer.disconnect()\n          setTimeout(mount, 150)\n        })\n        observer.observe($productItems[0], {\n          childList: true\n        })\n        const fallbackTimer = setTimeout(() => {\n          observer.disconnect()\n          mount()\n        }, 3000)\n      } else {\n        mount()\n      }\n    } else {\n      vueApp.$mount($searchEngine)\n    }\n  }\n}\n","\n/**\n * vue-simple-portal\n * version: 0.1.5,\n * (c) Thorsten LÃ¼nborg, 2021 - present\n * LICENCE: Apache-2.0\n * http://github.com/linusborg/vue-simple-portal\n*/\nimport Vue from 'vue';\nimport { nanoid } from 'nanoid/non-secure';\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function (obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function (obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nvar config = {\n  selector: \"vue-portal-target-\".concat(nanoid())\n};\nvar setSelector = function setSelector(selector) {\n  return config.selector = selector;\n};\nvar isBrowser = typeof window !== 'undefined' && (typeof document === \"undefined\" ? \"undefined\" : _typeof(document)) !== undefined;\n\nvar TargetContainer = Vue.extend({\n  // as an abstract component, it doesn't appear in\n  // the $parent chain of components.\n  // which means the next parent of any component rendered inside of this oen\n  // will be the parent from which is was sent\n  // @ts-expect-error\n  abstract: true,\n  name: 'PortalOutlet',\n  props: ['nodes', 'tag'],\n  data: function data(vm) {\n    return {\n      updatedNodes: vm.nodes\n    };\n  },\n  render: function render(h) {\n    var nodes = this.updatedNodes && this.updatedNodes();\n    if (!nodes) return h();\n    return nodes.length === 1 && !nodes[0].text ? nodes : h(this.tag || 'DIV', nodes);\n  },\n  destroyed: function destroyed() {\n    var el = this.$el;\n    el && el.parentNode.removeChild(el);\n  }\n});\n\nvar Portal = Vue.extend({\n  name: 'VueSimplePortal',\n  props: {\n    disabled: {\n      type: Boolean\n    },\n    prepend: {\n      type: Boolean\n    },\n    selector: {\n      type: String,\n      default: function _default() {\n        return \"#\".concat(config.selector);\n      }\n    },\n    tag: {\n      type: String,\n      default: 'DIV'\n    }\n  },\n  render: function render(h) {\n    if (this.disabled) {\n      var nodes = this.$scopedSlots && this.$scopedSlots.default();\n      if (!nodes) return h();\n      return nodes.length < 2 && !nodes[0].text ? nodes : h(this.tag, nodes);\n    }\n\n    return h();\n  },\n  created: function created() {\n    if (!this.getTargetEl()) {\n      this.insertTargetEl();\n    }\n  },\n  updated: function updated() {\n    var _this = this;\n\n    // We only update the target container component\n    // if the scoped slot function is a fresh one\n    // The new slot syntax (since Vue 2.6) can cache unchanged slot functions\n    // and we want to respect that here.\n    this.$nextTick(function () {\n      if (!_this.disabled && _this.slotFn !== _this.$scopedSlots.default) {\n        _this.container.updatedNodes = _this.$scopedSlots.default;\n      }\n\n      _this.slotFn = _this.$scopedSlots.default;\n    });\n  },\n  beforeDestroy: function beforeDestroy() {\n    this.unmount();\n  },\n  watch: {\n    disabled: {\n      immediate: true,\n      handler: function handler(disabled) {\n        disabled ? this.unmount() : this.$nextTick(this.mount);\n      }\n    }\n  },\n  methods: {\n    // This returns the element into which the content should be mounted.\n    getTargetEl: function getTargetEl() {\n      if (!isBrowser) return;\n      return document.querySelector(this.selector);\n    },\n    insertTargetEl: function insertTargetEl() {\n      if (!isBrowser) return;\n      var parent = document.querySelector('body');\n      var child = document.createElement(this.tag);\n      child.id = this.selector.substring(1);\n      parent.appendChild(child);\n    },\n    mount: function mount() {\n      if (!isBrowser) return;\n      var targetEl = this.getTargetEl();\n      var el = document.createElement('DIV');\n\n      if (this.prepend && targetEl.firstChild) {\n        targetEl.insertBefore(el, targetEl.firstChild);\n      } else {\n        targetEl.appendChild(el);\n      }\n\n      this.container = new TargetContainer({\n        el: el,\n        parent: this,\n        propsData: {\n          tag: this.tag,\n          nodes: this.$scopedSlots.default\n        }\n      });\n    },\n    unmount: function unmount() {\n      if (this.container) {\n        this.container.$destroy();\n        delete this.container;\n      }\n    }\n  }\n});\n\nfunction install(_Vue) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  _Vue.component(options.name || 'portal', Portal);\n\n  if (options.defaultSelector) {\n    setSelector(options.defaultSelector);\n  }\n}\n\nif (typeof window !== 'undefined' && window.Vue && window.Vue === Vue) {\n  // plugin was inlcuded directly in a browser\n  Vue.use(install);\n}\n\nexport default install;\nexport { Portal, config, setSelector };\n","// This alphabet uses `A-Za-z0-9_-` symbols. The genetic algorithm helped\n// optimize the gzip compression for this alphabet.\nlet urlAlphabet =\n  'ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW'\n\nlet customAlphabet = (alphabet, size) => {\n  return () => {\n    let id = ''\n    // A compact alternative for `for (var i = 0; i < step; i++)`.\n    let i = size\n    while (i--) {\n      // `| 0` is more compact and faster than `Math.floor()`.\n      id += alphabet[(Math.random() * alphabet.length) | 0]\n    }\n    return id\n  }\n}\n\nlet nanoid = (size = 21) => {\n  let id = ''\n  // A compact alternative for `for (var i = 0; i < step; i++)`.\n  let i = size\n  while (i--) {\n    // `| 0` is more compact and faster than `Math.floor()`.\n    id += urlAlphabet[(Math.random() * 64) | 0]\n  }\n  return id\n}\n\nexport { nanoid, customAlphabet }\n"],"sourceRoot":""}