{"version":3,"sources":["webpack:///./node_modules/@ecomplus/widget-tag-manager/src/index.js","webpack:///./node_modules/@ecomplus/widget-tag-manager/src/lib/common.js","webpack:///./node_modules/@ecomplus/widget-tag-manager/src/lib/parse-context.js","webpack:///./node_modules/@ecomplus/widget-tag-manager/src/lib/parse-dom.js","webpack:///./node_modules/@ecomplus/widget-tag-manager/src/lib/watch-app-routes.js","webpack:///./node_modules/@ecomplus/widget-tag-manager/src/lib/watch-shopping-cart.js"],"names":["options","dataLayerVar","parseDomMsDelay","dataLayer","window","parseContext","watchAppRoutes","watchShoppingCart","setTimeout","parseDom","currencyCode","$ecomConfig","get","getProductData","item","productData","name","id","sku","price","toFixed","quantity","context","storefront","resource","body","data","event","ecommerce","detail","products","categories","categoriesList","length","category","category_tree","replace","actionField","list","brands","brand","push","$products","document","querySelectorAll","skus","listNameBySku","isSearchPage","location","pathname","defaultList","i","$product","dataset","indexOf","closest","$carousel","title","impressions","map","listName","router","storefrontApp","isCartSent","isCheckoutSent","isPurchaseSent","getCartProductsList","ecomCart","Array","isArray","items","forEach","emitCheckoutOption","checkout_option","emitCheckout","step","option","checkout","emitPurchase","orderId","orderJson","amount","revenue","total","subtotal","freight","undefined","shipping","tax","order","JSON","parse","e","field","extra_discount","discount_coupon","coupon","purchase","emitPurchaseTimer","addRouteToData","params","clearTimeout","json","decodeURIComponent","currentRoute","afterEach","productsBySku","emitAddToCart","add","emitRemoveFromCart","remove","Object","assign","on"],"mappings":"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","file":"chunk.590fa1893bd8fe73bcf4.js","sourcesContent":["import parseContext from './lib/parse-context'\nimport parseDom from './lib/parse-dom'\nimport watchAppRoutes from './lib/watch-app-routes'\nimport watchShoppingCart from './lib/watch-shopping-cart'\n\nexport default (options = {}) => {\n  const { dataLayerVar, parseDomMsDelay } = options\n  const dataLayer = window[dataLayerVar] || window.dataLayer\n\n  if (dataLayer) {\n    parseContext(dataLayer)\n    watchAppRoutes(dataLayer)\n    watchShoppingCart(dataLayer)\n\n    setTimeout(() => {\n      parseDom(dataLayer)\n    }, parseDomMsDelay >= 0 ? parseDomMsDelay : 300)\n  }\n}\n","import { $ecomConfig, name, price } from '@ecomplus/utils'\n\nexport const currencyCode = $ecomConfig.get('currency') || 'BRL'\n\nexport const getProductData = item => {\n  const productData = {\n    name: name(item),\n    id: item.sku,\n    price: price(item).toFixed(2)\n  }\n  if (item.quantity) {\n    productData.quantity = item.quantity\n  }\n  return productData\n}\n","import { categoriesList } from '@ecomplus/utils'\nimport { currencyCode, getProductData } from './common'\n\nexport default dataLayer => {\n  const context = window.storefront && window.storefront.context\n  if (context && context.resource === 'products') {\n    const { body } = context\n\n    const productData = getProductData(body)\n    const data = {\n      event: 'eec.detail',\n      ecommerce: {\n        currencyCode,\n        detail: {\n          products: [productData]\n        }\n      }\n    }\n\n    const categories = categoriesList(body)\n    if (categories.length) {\n      productData.category = body.category_tree\n        ? body.category_tree.replace(/\\s>\\s/g, '/') : categories[0]\n      data.ecommerce.detail.actionField = {\n        list: categories[0]\n      }\n    }\n    if (body.brands && body.brands.length) {\n      productData.brand = body.brands[0].name\n    }\n\n    dataLayer.push(data)\n  }\n}\n","import { currencyCode } from './common'\n\nexport default dataLayer => {\n  const $products = document.querySelectorAll('[data-sku]')\n  if ($products.length) {\n    const skus = []\n    const listNameBySku = {}\n    const isSearchPage = window.location.pathname === '/search'\n\n    let defaultList\n    if (isSearchPage) {\n      defaultList = 'Search results'\n    } else {\n      const context = window.storefront && window.storefront.context\n      if (context && context.body) {\n        const { name } = context.body\n        switch (context.resource) {\n          case 'categories':\n            defaultList = `Category: ${name}`\n            break\n          case 'brands':\n            defaultList = `Brand: ${name}`\n            break\n          case 'collections':\n            defaultList = `Collection: ${name}`\n        }\n      }\n    }\n\n    for (let i = 0; i < $products.length; i++) {\n      const $product = $products[i]\n      const { sku } = $product.dataset\n      if (skus.indexOf(sku) === -1) {\n        skus.push(sku)\n\n        if ($product.closest) {\n          const $carousel = $product.closest('.products-carousel')\n          if (!isSearchPage && $carousel) {\n            listNameBySku[sku] = $carousel.dataset.title\n          }\n        }\n      }\n    }\n\n    dataLayer.push({\n      event: 'eec.impressions',\n      ecommerce: {\n        currencyCode,\n        impressions: skus.map(sku => {\n          const listName = listNameBySku[sku] || defaultList\n          const item = { id: sku }\n          if (listName) {\n            item.list = listName\n          }\n          return item\n        })\n      }\n    })\n  }\n}\n","import ecomCart from '@ecomplus/shopping-cart'\nimport { currencyCode, getProductData } from './common'\n\nexport default dataLayer => {\n  const router = window.storefrontApp && window.storefrontApp.router\n  if (router) {\n    let isCartSent, isCheckoutSent, isPurchaseSent\n    const getCartProductsList = () => {\n      const products = []\n      if (ecomCart.data && Array.isArray(ecomCart.data.items)) {\n        ecomCart.data.items.forEach(item => {\n          products.push(getProductData(item))\n        })\n      }\n      return products\n    }\n\n    const emitCheckoutOption = actionField => {\n      dataLayer.push({\n        event: 'eec.checkout_option',\n        ecommerce: {\n          currencyCode,\n          checkout_option: { actionField }\n        }\n      })\n    }\n\n    const emitCheckout = (step, option) => {\n      const actionField = { step, option }\n      if (step <= 1 || !isCartSent) {\n        dataLayer.push({\n          event: 'eec.checkout',\n          ecommerce: {\n            currencyCode,\n            checkout: {\n              actionField,\n              products: getCartProductsList()\n            }\n          }\n        })\n        dataLayer.push({ event: 'checkout' })\n        isCartSent = true\n      } else if (!isCheckoutSent) {\n        emitCheckoutOption(actionField)\n        dataLayer.push({ event: 'checkoutOption' })\n        isCheckoutSent = true\n      }\n    }\n\n    const emitPurchase = (orderId, orderJson) => {\n      if (!isPurchaseSent) {\n        const { amount } = window.storefrontApp\n        const actionField = {\n          id: orderId,\n          revenue: (\n            (amount && amount.total) ||\n            (ecomCart.data && ecomCart.data.subtotal) ||\n            0\n          ).toFixed(2)\n        }\n        if (amount) {\n          if (amount.freight !== undefined) {\n            actionField.shipping = amount.freight.toFixed(2)\n          }\n          if (amount.tax !== undefined) {\n            actionField.tax = amount.tax.toFixed(2)\n          }\n        }\n\n        let order\n        if (orderJson) {\n          try {\n            order = JSON.parse(orderJson)\n          } catch (e) {\n          }\n        }\n        if (order) {\n          ;['payment_method_label', 'shipping_method_label'].forEach((field, i) => {\n            if (order[field]) {\n              emitCheckoutOption({\n                step: 3 + i,\n                option: order[field]\n              })\n            }\n          })\n          if (order.extra_discount && order.extra_discount.discount_coupon) {\n            actionField.coupon = order.extra_discount.discount_coupon\n          }\n        }\n\n        dataLayer.push({\n          event: 'eec.purchase',\n          ecommerce: {\n            currencyCode,\n            purchase: {\n              actionField,\n              products: getCartProductsList()\n            }\n          }\n        })\n        isPurchaseSent = true\n      }\n    }\n\n    let emitPurchaseTimer\n    const addRouteToData = ({ name, params }) => {\n      switch (name) {\n        case 'cart':\n          emitCheckout(1, 'Review Cart')\n          break\n        case 'checkout':\n          emitCheckout(2, 'Confirm Purchase')\n          break\n        case 'confirmation':\n          clearTimeout(emitPurchaseTimer)\n          if (params.json) {\n            emitPurchase(params.id, decodeURIComponent(params.json))\n          } else {\n            emitPurchaseTimer = setTimeout(() => {\n              emitPurchase(params.id)\n            }, 1500)\n          }\n          break\n      }\n    }\n\n    if (router.currentRoute) {\n      addRouteToData(router.currentRoute)\n    }\n    router.afterEach(addRouteToData)\n  }\n}\n","import ecomCart from '@ecomplus/shopping-cart'\nimport { currencyCode, getProductData } from './common'\n\nexport default dataLayer => {\n  const productsBySku = {}\n\n  const emitAddToCart = item => {\n    const productData = getProductData(item)\n    dataLayer.push({\n      event: 'eec.add',\n      ecommerce: {\n        currencyCode,\n        add: {\n          products: [productData]\n        }\n      }\n    })\n    dataLayer.push({ event: 'addToCart' })\n    productsBySku[item.sku] = productData\n  }\n\n  const emitRemoveFromCart = item => {\n    const productData = productsBySku[item.sku]\n    dataLayer.push({\n      event: 'eec.remove',\n      ecommerce: {\n        currencyCode,\n        remove: {\n          products: [\n            (productData ? Object.assign({}, productData) : getProductData(item))\n          ]\n        }\n      }\n    })\n    dataLayer.push({ event: 'removeFromCart' })\n    delete productsBySku[item.sku]\n  }\n\n  ecomCart.on('addItem', ({ item }) => emitAddToCart(item))\n\n  ecomCart.on('increaseItemQnt', ({ item }) => {\n    const productData = productsBySku[item.sku]\n    if (!productData) {\n      emitAddToCart(item)\n    } else {\n      const quantity = item.quantity - productData.quantity\n      if (quantity > 0) {\n        emitAddToCart({ ...item, quantity })\n      } else {\n        emitRemoveFromCart({\n          ...item,\n          quantity: -quantity\n        })\n      }\n    }\n  })\n\n  ecomCart.on('removeItem', ({ item }) => emitRemoveFromCart(item))\n\n  ecomCart.on('clear', () => {\n    for (const sku in productsBySku) {\n      if (productsBySku[sku]) {\n        emitRemoveFromCart(productsBySku[sku])\n      }\n    }\n  })\n}\n"],"sourceRoot":""}