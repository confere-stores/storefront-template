{"version":3,"sources":["webpack:///./node_modules/@confere-stores/storefront-components/src/DiscountApplier.vue","webpack:///./node_modules/@confere-stores/storefront-components/src/RecommendedItems.vue","webpack:///./node_modules/@confere-stores/storefront-components/src/html/DiscountApplier.html","webpack:///./node_modules/@confere-stores/storefront-components/src/html/RecommendedItems.html","webpack:///./node_modules/@confere-stores/storefront-components/src/js/DiscountApplier.js?0d1b","webpack:///./node_modules/@confere-stores/storefront-components/src/js/DiscountApplier.js","webpack:///./node_modules/@confere-stores/storefront-components/src/js/RecommendedItems.js","webpack:///./node_modules/@confere-stores/storefront-components/src/js/RecommendedItems.js?de74","webpack:///./node_modules/@confere-stores/storefront-components/src/js/helpers/wait-storefront-info.js","webpack:///./node_modules/@confere-stores/storefront-components/src/scss/DiscountApplier.scss?7fe5","webpack:///./node_modules/@confere-stores/storefront-components/src/scss/RecommendedItems.scss?1dec","webpack:///./node_modules/@confere-stores/storefront-components/src/scss/DiscountApplier.scss","webpack:///./node_modules/@confere-stores/storefront-components/src/scss/RecommendedItems.scss","webpack:///./node_modules/@confere-stores/storefront-components/src/html/DiscountApplier.html?9d76","webpack:///./node_modules/@confere-stores/storefront-components/src/html/RecommendedItems.html?6da4","webpack:///./node_modules/@confere-stores/storefront-components/src/scss/DiscountApplier.scss?dcd5","webpack:///./node_modules/@confere-stores/storefront-components/src/scss/RecommendedItems.scss?0818"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAA8G;AACzC;AACL;AACkB;;;AAGlF;AACgF;AAChF,gBAAgB,8FAAU;AAC1B,EAAE,uFAAM;AACR,EAAE,0GAAM;AACR,EAAE,mHAAe;AACjB;AACA;AACA;AACA;;AAEA;;AAEA;AACA,IAAI,KAAU,EAAE,YAiBf;AACD;AACe,gF;;;;;;;;;;;;ACvCf;AAAA;AAAA;AAAA;AAAA;AAA+G;AACzC;AACL;AACkB;;;AAGnF;AACgF;AAChF,gBAAgB,8FAAU;AAC1B,EAAE,wFAAM;AACR,EAAE,2GAAM;AACR,EAAE,oHAAe;AACjB;AACA;AACA;AACA;;AAEA;;AAEA;AACA,IAAI,KAAU,EAAE,YAiBf;AACD;AACe,gF;;;;;;;;;;;;ACvCf;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA,wCAAkE,CAAgB,mJAAG,EAAC,C;;;;;;;;;;;;ACAtF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAUuB;;AAEe;AACW;AACH;AACM;AAClB;;AAElC;AACA;AACA;AACA;AACA,QAAQ,8DAAK,EAAE,mBAAmB,UAAU,QAAQ;AACpD,kBAAkB,OAAO;AACzB;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA,eAAe;AACf;AACA,WAAW;AACX;AACA;AACA,KAAK;AACL;AACA;;AAEe;AACf;;AAEA;AACA,IAAI,2DAAM;AACV,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,eAAe,+DAAQ;AACvB;AACA,KAAK;AACL;AACA;AACA;AACA,eAAe,iEAAY;AAC3B;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,kBAAkB,4DAAI,CAAC,qDAAM;AAC7B,gCAAgC,4DAAI,CAAC,mEAAoB;AACzD,mBAAmB,4DAAI,CAAC,sDAAO;AAC/B,+BAA+B,4DAAI,CAAC,kEAAmB;AACvD,6BAA6B,4DAAI,CAAC,gEAAiB;AACnD,mCAAmC,4DAAI,CAAC,sEAAuB;AAC/D,+BAA+B,4DAAI,CAAC,kEAAmB;AACvD,iCAAiC,4DAAI,CAAC,oEAAqB;;AAE3D;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,iBAAiB,6BAA6B;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,4CAA4C;AAC5C;AACA;AACA,KAAK;;AAEL,mCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM,gEAAO;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP,gBAAgB,OAAO;AACvB;AACA;AACA;AACA,2BAA2B,4DAAI,CAAC,0DAAW;AAC3C,SAAS;AACT;AACA;AACA,SAAS;AACT,KAAK;;AAEL;AACA;AACA,eAAe,kBAAkB;AACjC;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,SAAS;AACT;AACA,KAAK;;AAEL;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA,CAAC;;;;;;;;;;;;;AC5QD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIuB;;AAKC;;AAEiB;AACO;AACF;AACM;AACK;AACb;;AAE7B;AACf;;AAEA;AACA,IAAI,qEAAW;AACf,GAAG;;AAEH;AACA;AACA;AACA,gBAAgB,kEAAQ;AACxB,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,mBAAmB,4DAAI,CAAC,qDAAM;AAC9B,gCAAgC;AAChC;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,eAAe,+DAAQ;AACvB;AACA;AACA,GAAG;;AAEH;AACA;AACA,sBAAsB,+DAAU;AAChC;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,GAAG;;AAEH;AACA,sBAAsB,4DAAI,CAAC,yDAAU;AACrC,+BAA+B,4DAAI,CAAC,kEAAmB;AACvD,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,OAAO;AACP;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA,qBAAqB,4BAA4B;AACjD,sBAAsB,+DAAM,EAAE,mBAAmB,aAAa,GAAG,UAAU,QAAQ;AACnF;AACA;AACA;AACA,0BAA0B,gBAAgB;AAC1C;AACA,YAAY,sEAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP;AACA,IAAI,0EAAe;AACnB;AACA,KAAK;AACL,GAAG;;AAEH;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,KAAK;;AAEL;AACA;AACA;AACA,OAAO;AACP;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,CAAC;;;;;;;;;;;;;AC/JD;AAAA;AAAA,wCAAmE,CAAgB,oJAAG,EAAC,C;;;;;;;;;;;;ACAvF;AAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,SAAS;AACrC;AACA;AACA,CAAC,CAAC;;;;;;;;;;;;;ACfF;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;;;;;;;;;;;;ACAA;AACA,kCAAkC,mBAAO,CAAC,iGAA4C;AACtF;AACA;AACA,cAAc,QAAS,qBAAqB,gBAAgB,yBAAyB,uBAAuB,iDAAiD,2BAA2B,yBAAyB,8BAA8B,yBAAyB,gBAAgB,OAAO,sOAAsO,qBAAqB,sDAAsD,sBAAsB,qBAAqB,gBAAgB,8BAA8B,KAAK,eAAe,kCAAkC,KAAK,cAAc,kCAAkC,qCAAqC,KAAK,gBAAgB,uBAAuB,KAAK,GAAG,KAAK;AACl3B;AACA;;;;;;;;;;;;ACNA;AACA,kCAAkC,mBAAO,CAAC,iGAA4C;AACtF;AACA;AACA,cAAc,QAAS,6BAA6B,kBAAkB,8BAA8B,kBAAkB,8BAA8B,wBAAwB,6BAA6B,iCAAiC,8BAA8B,sCAAsC,UAAU,gBAAgB,cAAc,OAAO,4QAA4Q,qBAAqB,sDAAsD,uBAAuB,cAAc,yBAAyB,KAAK,oBAAoB,yBAAyB,qCAAqC,KAAK,YAAY,oCAAoC,KAAK,qBAAqB,qCAAqC,gBAAgB,mBAAmB,yBAAyB,uBAAuB,OAAO,KAAK,GAAG,KAAK;AACpiC;AACA;;;;;;;;;;;;;ACNA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK,kCAAkC;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA,+BAA+B,gBAAgB;AAC/C;AACA,oCAAoC,yCAAyC;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,iBAAiB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA,mCAAmC,iCAAiC;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA,mCAAmC,4BAA4B;AAC/D;AACA;AACA,6BAA6B,SAAS,iCAAiC,EAAE;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,6BAA6B;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B;AAC/B,yCAAyC,6BAA6B;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA,uCAAuC,oCAAoC;AAC3E;AACA;AACA;AACA,qCAAqC,kCAAkC;AACvE;AACA;AACA;AACA;AACA,gDAAgD;AAChD,uCAAuC;AACvC;AACA,kDAAkD,yBAAyB;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C;AAC9C,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C;AAC9C,qCAAqC;AACrC;AACA;AACA;AACA,uCAAuC;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AChMA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK,mCAAmC;AACxC;AACA,wBAAwB,SAAS,0CAA0C,EAAE;AAC7E;AACA;AACA;AACA;AACA,iBAAiB,0CAA0C;AAC3D;AACA;AACA,6BAA6B,sBAAsB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,0BAA0B;AAC3C;AACA;AACA;AACA,qBAAqB,yCAAyC;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,SAAS,mCAAmC,EAAE;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,6BAA6B,8CAA8C;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B;AACA,qCAAqC,kCAAkC;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACxFA;;AAEA;AACA,cAAc,mBAAO,CAAC,iqBAAgV;AACtW;AACA,4CAA4C,QAAS;AACrD;AACA;AACA,UAAU,mBAAO,CAAC,mHAAsD;AACxE,+CAA+C;AAC/C;AACA,GAAG,KAAU,EAAE,E;;;;;;;;;;;ACXf;;AAEA;AACA,cAAc,mBAAO,CAAC,mqBAAiV;AACvW;AACA,4CAA4C,QAAS;AACrD;AACA;AACA,UAAU,mBAAO,CAAC,mHAAsD;AACxE,+CAA+C;AAC/C;AACA,GAAG,KAAU,EAAE,E","file":"chunk.cd68c235bf13230974cd.js","sourcesContent":["import { render, staticRenderFns } from \"./html/DiscountApplier.html?vue&type=template&id=16886120&lang=html&\"\nimport script from \"./js/DiscountApplier.js?vue&type=script&lang=js&\"\nexport * from \"./js/DiscountApplier.js?vue&type=script&lang=js&\"\nimport style0 from \"./scss/DiscountApplier.scss?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/Users/jescudero/ConfereCartoes/@confere-stores/storefront-template/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('16886120')) {\n      api.createRecord('16886120', component.options)\n    } else {\n      api.reload('16886120', component.options)\n    }\n    module.hot.accept(\"./html/DiscountApplier.html?vue&type=template&id=16886120&lang=html&\", function () {\n      api.rerender('16886120', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"node_modules/@confere-stores/storefront-components/src/DiscountApplier.vue\"\nexport default component.exports","import { render, staticRenderFns } from \"./html/RecommendedItems.html?vue&type=template&id=4739dba2&lang=html&\"\nimport script from \"./js/RecommendedItems.js?vue&type=script&lang=js&\"\nexport * from \"./js/RecommendedItems.js?vue&type=script&lang=js&\"\nimport style0 from \"./scss/RecommendedItems.scss?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/Users/jescudero/ConfereCartoes/@confere-stores/storefront-template/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('4739dba2')) {\n      api.createRecord('4739dba2', component.options)\n    } else {\n      api.reload('4739dba2', component.options)\n    }\n    module.hot.accept(\"./html/RecommendedItems.html?vue&type=template&id=4739dba2&lang=html&\", function () {\n      api.rerender('4739dba2', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"node_modules/@confere-stores/storefront-components/src/RecommendedItems.vue\"\nexport default component.exports","export * from \"-!../../../../vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./DiscountApplier.html?vue&type=template&id=16886120&lang=html&\"","export * from \"-!../../../../vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./RecommendedItems.html?vue&type=template&id=4739dba2&lang=html&\"","import mod from \"-!./DiscountApplier.js?vue&type=script&lang=js&\"; export default mod; export * from \"-!./DiscountApplier.js?vue&type=script&lang=js&\"","import {\n  i19add,\n  i19addDiscountCoupon,\n  i19campaignAppliedMsg,\n  i19code,\n  i19couponAppliedMsg,\n  i19discountCoupon,\n  i19errorMsg,\n  i19hasCouponOrVoucherQn,\n  i19invalidCouponMsg\n} from '@ecomplus/i18n'\n\nimport { i18n } from '@ecomplus/utils'\nimport { store, modules } from '@ecomplus/client'\nimport ecomCart from '@ecomplus/shopping-cart'\nimport ecomPassport from '@ecomplus/passport-client'\nimport AAlert from '../AAlert.vue'\n\nconst addFreebieItems = (ecomCart, productIds) => {\n  if (Array.isArray(productIds)) {\n    productIds.forEach(productId => {\n      if (!ecomCart.data.items.find(item => item.product_id === productId)) {\n        store({ url: `/products/${productId}.json` })\n          .then(({ data }) => {\n            ecomCart.addProduct(\n              {\n                ...data,\n                flags: ['freebie', '__tmp']\n              },\n              null,\n              productIds.reduce((qnt, _id) => {\n                return _id === productId ? qnt + 1 : qnt\n              }, 0)\n            )\n          })\n          .catch(console.error)\n      }\n    })\n  }\n}\n\nexport default {\n  name: 'DiscountApplier',\n\n  components: {\n    AAlert\n  },\n\n  props: {\n    amount: Object,\n    couponCode: String,\n    hasCouponInput: {\n      type: Boolean,\n      default: true\n    },\n    isFormAlwaysVisible: Boolean,\n    isCouponApplied: Boolean,\n    isAttentionWanted: Boolean,\n    canAddFreebieItems: {\n      type: Boolean,\n      default: true\n    },\n    modulesPayload: Object,\n    ecomCart: {\n      type: Object,\n      default () {\n        return ecomCart\n      }\n    },\n    ecomPassport: {\n      type: Object,\n      default () {\n        return ecomPassport\n      }\n    }\n  },\n\n  data () {\n    return {\n      alertText: null,\n      alertVariant: null,\n      isFormVisible: this.isFormAlwaysVisible || this.couponCode,\n      isLoading: false,\n      localCouponCode: this.couponCode,\n      localAmountTotal: null,\n      isUpdateSheduled: false\n    }\n  },\n\n  computed: {\n    i19add: () => i18n(i19add),\n    i19addDiscountCoupon: () => i18n(i19addDiscountCoupon),\n    i19code: () => i18n(i19code),\n    i19couponAppliedMsg: () => i18n(i19couponAppliedMsg),\n    i19discountCoupon: () => i18n(i19discountCoupon),\n    i19hasCouponOrVoucherQn: () => i18n(i19hasCouponOrVoucherQn),\n    i19invalidCouponMsg: () => i18n(i19invalidCouponMsg),\n    i19campaignAppliedMsg: () => i18n(i19campaignAppliedMsg),\n\n    canAddCoupon () {\n      return !this.couponCode || !this.isCouponApplied ||\n        this.couponCode !== this.localCouponCode\n    }\n  },\n\n  methods: {\n    fixAmount () {\n      const amount = this.amount || {\n        subtotal: this.ecomCart.data.subtotal\n      }\n      this.localAmountTotal = (amount.subtotal || 0) + (amount.freight || 0)\n    },\n\n    parseDiscountOptions (listResult = []) {\n      let extraDiscountValue = 0\n      if (listResult.length) {\n        let discountRule, invalidCouponMsg\n        listResult.forEach(appResult => {\n          const { validated, error, response } = appResult\n          if (validated && !error) {\n            const appDiscountRule = response.discount_rule\n            if (appDiscountRule) {\n              const discountRuleValue = appDiscountRule.extra_discount.value\n              if (!(extraDiscountValue > discountRuleValue)) {\n                extraDiscountValue = discountRuleValue\n                discountRule = {\n                  app_id: appResult.app_id,\n                  ...appDiscountRule\n                }\n              }\n            } else if (response.invalid_coupon_message) {\n              invalidCouponMsg = response.invalid_coupon_message\n            }\n            if (this.canAddFreebieItems) {\n              addFreebieItems(this.ecomCart, response.freebie_product_ids)\n            }\n          }\n        })\n        if (extraDiscountValue) {\n          if (this.localCouponCode) {\n            this.$emit('update:coupon-code', this.localCouponCode)\n            this.alertText = this.i19couponAppliedMsg\n          } else {\n            this.alertText = this.i19campaignAppliedMsg\n          }\n          this.$emit('set-discount-rule', discountRule)\n          this.alertVariant = 'info'\n        } else {\n          if (this.localCouponCode) {\n            this.alertText = invalidCouponMsg || this.i19invalidCouponMsg\n            this.alertVariant = 'warning'\n          } else {\n            this.alertText = null\n          }\n          this.$emit('set-discount-rule', {})\n        }\n      }\n    },\n\n    fetchDiscountOptions (data = {}) {\n      this.isLoading = true\n      if (this.ecomPassport.checkLogin()) {\n        const customer = this.ecomPassport.getCustomer()\n        data.customer = {\n          _id: customer._id\n        }\n        if (customer.display_name) {\n          data.customer.display_name = customer.display_name\n        }\n      }\n      modules({\n        url: '/apply_discount.json',\n        method: 'POST',\n        data: {\n          ...this.modulesPayload,\n          amount: {\n            subtotal: this.localAmountTotal,\n            ...this.amount,\n            total: this.localAmountTotal,\n            discount: 0\n          },\n          items: this.ecomCart.data.items,\n          ...data\n        }\n      })\n        .then(({ data }) => this.parseDiscountOptions(data.result))\n        .catch(err => {\n          console.error(err)\n          this.alertVariant = 'danger'\n          this.alertText = i18n(i19errorMsg)\n        })\n        .finally(() => {\n          this.isLoading = false\n        })\n    },\n\n    submitCoupon (isForceUpdate) {\n      if (isForceUpdate || this.canAddCoupon) {\n        const { localCouponCode } = this\n        const data = {\n          discount_coupon: localCouponCode\n        }\n        this.fetchDiscountOptions(data)\n      }\n    },\n\n    updateDiscount (isForceUpdate = true) {\n      if (this.couponCode) {\n        if (isForceUpdate || !this.isCouponApplied) {\n          this.submitCoupon(isForceUpdate)\n        }\n      } else if (\n        isForceUpdate ||\n        (!this.isUpdateSheduled && this.amount && this.amount.total)\n      ) {\n        this.fetchDiscountOptions()\n      }\n    }\n  },\n\n  watch: {\n    couponCode (couponCode) {\n      if (couponCode !== this.couponCode) {\n        this.localCouponCode = couponCode\n        if (couponCode && !this.isFormVisible) {\n          this.isFormVisible = true\n        }\n      }\n    },\n\n    isFormAlwaysVisible (isFormVisible) {\n      if (isFormVisible) {\n        this.isFormVisible = true\n      }\n    },\n\n    isFormVisible (isFormVisible) {\n      if (isFormVisible) {\n        this.$nextTick(() => {\n          this.$refs.input.focus()\n        })\n      }\n    },\n\n    localAmountTotal (total, oldTotal) {\n      if (oldTotal !== null && Math.abs(total - oldTotal) > 0.01 && !this.isUpdateSheduled) {\n        this.isUpdateSheduled = true\n        this.$nextTick(() => {\n          setTimeout(() => {\n            this.updateDiscount()\n            this.isUpdateSheduled = false\n          }, 600)\n        })\n      }\n    },\n\n    amount: {\n      handler () {\n        this.fixAmount()\n      },\n      deep: true\n    }\n  },\n\n  mounted () {\n    this.fixAmount()\n    this.updateDiscount(false)\n  }\n}\n","import {\n  i19add,\n  i19seeMore,\n  i19weRecommendToYou\n} from '@ecomplus/i18n'\n\nimport {\n  i18n,\n  recommendedIds as getRecommendedIds\n} from '@ecomplus/utils'\n\nimport { graphs } from '@ecomplus/client'\nimport EcomSearch from '@ecomplus/search-engine'\nimport ecomCart from '@ecomplus/shopping-cart'\nimport { isMobile } from '@ecomplus/storefront-twbs'\nimport addIdleCallback from './helpers/add-idle-callback'\nimport ProductCard from '../ProductCard.vue'\n\nexport default {\n  name: 'RecommendedItems',\n\n  components: {\n    ProductCard\n  },\n\n  props: {\n    pageSize: {\n      type: Number,\n      default: !isMobile ? 4 : 2\n    },\n    sortOrder: {\n      type: String,\n      default: 'sales'\n    },\n    canLoadMore: {\n      type: Boolean,\n      default: true\n    },\n    rowClassName: {\n      type: String,\n      default: 'row no-gutters'\n    },\n    colClassName: {\n      type: String,\n      default: 'col-6 col-md-4 col-lg-3'\n    },\n    productCardProps: {\n      type: Object,\n      default () {\n        return {\n          isSmall: true,\n          buyText: i18n(i19add),\n          installmentsOption: {},\n          discountOption: {}\n        }\n      }\n    },\n    ecomCart: {\n      type: Object,\n      default () {\n        return ecomCart\n      }\n    }\n  },\n\n  data () {\n    return {\n      ecomSearch: new EcomSearch()\n        .mergeFilter({\n          range: {\n            quantity: {\n              gt: 0\n            }\n          }\n        })\n        .mergeFilter({\n          term: {\n            available: true\n          }\n        }),\n      pageNumber: 1,\n      items: []\n    }\n  },\n\n  computed: {\n    i19seeMore: () => i18n(i19seeMore),\n    i19weRecommendToYou: () => i18n(i19weRecommendToYou)\n  },\n\n  methods: {\n    fetchItems () {\n      delete this.ecomSearch.dsl.aggs\n      this.ecomSearch.setPageNumber(this.pageNumber).fetch().then(() => {\n        this.items = this.items.concat(this.ecomSearch.getItems())\n        this.totalCount = this.ecomSearch.getTotalCount()\n        if (this.totalCount) {\n          this.$emit('recommend-items', {\n            items: this.items,\n            totalCount: this.totalCount\n          })\n        }\n      })\n    }\n  },\n\n  created () {\n    const fetchRecommendations = (matchType = 'recommended') => {\n      const promises = []\n      const items = this.ecomCart.data.items.sort((a, b) => a.quantity > b.quantity ? -1 : 1)\n      for (let i = 0; i < items.length && i <= 4; i++) {\n        promises.push(graphs({ url: `/products/${items[i]._id}/${matchType}.json` }))\n      }\n      Promise.allSettled(promises).then(results => {\n        const productIds = []\n        results.forEach(({ status, value }) => {\n          if (status === 'fulfilled') {\n            getRecommendedIds(value.data).forEach(productId => {\n              if (\n                !productIds.includes(productId) &&\n                !this.ecomCart.data.items.find(item => item.product_id === productId)\n              ) {\n                productIds.push(productId)\n              }\n            })\n          }\n        })\n        if (productIds.length) {\n          this.ecomSearch.setProductIds(productIds.slice(0, 24))\n          this.fetchItems()\n        } else if (matchType === 'recommended') {\n          fetchRecommendations('related')\n        }\n      })\n    }\n    addIdleCallback(() => {\n      fetchRecommendations()\n    })\n  },\n\n  watch: {\n    pageSize: {\n      handler (pageSize) {\n        this.ecomSearch.setPageSize(pageSize)\n      },\n      immediate: true\n    },\n\n    sortOrder: {\n      handler (sortOrder) {\n        this.ecomSearch.setSortOrder(sortOrder)\n      },\n      immediate: true\n    },\n\n    pageNumber () {\n      this.fetchItems()\n    }\n  }\n}\n","import mod from \"-!./RecommendedItems.js?vue&type=script&lang=js&\"; export default mod; export * from \"-!./RecommendedItems.js?vue&type=script&lang=js&\"","export default (resource, field) => new Promise(resolve => {\n  const storefront = typeof window === 'object' && window.storefront\n  if (storefront) {\n    const getStorefrontInfo = () => {\n      const info = storefront.info && storefront.info[resource]\n      if (info && info[field] && Object.keys(info[field]).length) {\n        resolve(info[field])\n        return true\n      }\n      return false\n    }\n    if (!getStorefrontInfo()) {\n      storefront.on(`info:${resource}`, getStorefrontInfo)\n    }\n  }\n})\n","export * from \"-!../../../../vue-style-loader/index.js!../../../../css-loader/dist/cjs.js??ref--0-oneOf-0-1!../../../../vue-loader/lib/loaders/stylePostLoader.js!../../../../resolve-url-loader/index.js??ref--0-oneOf-0-2!../../../../postcss-loader/dist/cjs.js??ref--0-oneOf-0-3!../../../../sass-loader/dist/cjs.js??ref--0-oneOf-0-4!./DiscountApplier.scss?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../../vue-style-loader/index.js!../../../../css-loader/dist/cjs.js??ref--0-oneOf-0-1!../../../../vue-loader/lib/loaders/stylePostLoader.js!../../../../resolve-url-loader/index.js??ref--0-oneOf-0-2!../../../../postcss-loader/dist/cjs.js??ref--0-oneOf-0-3!../../../../sass-loader/dist/cjs.js??ref--0-oneOf-0-4!./RecommendedItems.scss?vue&type=style&index=0&lang=scss&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(true);\n// Module\nexports.push([module.id, \".discount-applier{max-width:30rem}.discount-applier__intro{color:var(--secondary)}.discount-applier .alert,.discount-applier__form{margin-top:var(--spacer-3)}.discount-applier .alert{font-size:var(--font-size-sm)}.discount-applier__input{max-width:200px}\", \"\",{\"version\":3,\"sources\":[\"DiscountApplier.scss\"],\"names\":[],\"mappings\":\"AAIA,kBACE,eAAgB,CAEhB,yBACE,sBAAuB,CAJ3B,iDAQI,0BAK8B,CAblC,yBAaI,6BAA8B,CAGhC,yBACE,eAAgB\",\"file\":\"DiscountApplier.scss\",\"sourcesContent\":[\"$primary: #e83e8c; $secondary: #333333; $settings-theme: (\\n  bootswatch: _,\\n  custom: _\\n); \\n.discount-applier {\\n  max-width: 30rem;\\n\\n  &__intro {\\n    color: var(--secondary);\\n  }\\n\\n  &__form {\\n    margin-top: var(--spacer-3);\\n  }\\n\\n  .alert {\\n    margin-top: var(--spacer-3);\\n    font-size: var(--font-size-sm);\\n  }\\n\\n  &__input {\\n    max-width: 200px;\\n  }\\n}\\n\"]}]);\n// Exports\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(true);\n// Module\nexports.push([module.id, \".recommended-items__title{text-align:center}.recommended-items__load-more{text-align:center;margin-bottom:var(--spacer-3)}.recommended-items .row{justify-content:space-around}.recommended-items .product-card{margin-bottom:var(--spacer-2)}.recommended-items .product-card__buy{opacity:1;position:static;display:block}\", \"\",{\"version\":3,\"sources\":[\"RecommendedItems.scss\"],\"names\":[],\"mappings\":\"AAKE,0BACE,iBAAkB,CAGpB,8BACE,iBAAkB,CAClB,6BAA8B,CAPlC,wBAWI,4BAA6B,CAXjC,iCAeI,6BAA8B,CAflC,sCAkBM,SAAU,CACV,eAAgB,CAChB,aAAc\",\"file\":\"RecommendedItems.scss\",\"sourcesContent\":[\"$primary: #e83e8c; $secondary: #333333; $settings-theme: (\\n  bootswatch: _,\\n  custom: _\\n); \\n.recommended-items {\\n  &__title {\\n    text-align: center;\\n  }\\n\\n  &__load-more {\\n    text-align: center;\\n    margin-bottom: var(--spacer-3);\\n  }\\n\\n  .row {\\n    justify-content: space-around;\\n  }\\n\\n  .product-card {\\n    margin-bottom: var(--spacer-2);\\n\\n    &__buy {\\n      opacity: 1;\\n      position: static;\\n      display: block;\\n    }\\n  }\\n}\\n\"]}]);\n// Exports\nmodule.exports = exports;\n","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    { staticClass: \"discount-applier\" },\n    [\n      _vm.hasCouponInput\n        ? [\n            _c(\n              \"transition-group\",\n              {\n                attrs: {\n                  \"enter-active-class\": \"animated fadeInDown\",\n                  \"leave-active-class\": \"animated position-absolute fadeOutUp\"\n                }\n              },\n              [\n                !_vm.isFormVisible\n                  ? _c(\"div\", { key: \"button\" }, [\n                      _vm.isAttentionWanted\n                        ? _c(\"h6\", { staticClass: \"discount-applier__intro\" }, [\n                            _vm._v(\n                              \"\\n          \" +\n                                _vm._s(_vm.i19hasCouponOrVoucherQn) +\n                                \"\\n        \"\n                            )\n                          ])\n                        : _vm._e(),\n                      _vm._v(\" \"),\n                      _c(\n                        \"button\",\n                        {\n                          staticClass:\n                            \"discount-applier__coupon-btn btn btn-sm\",\n                          class:\n                            \"btn-\" +\n                            (_vm.isAttentionWanted ? \"secondary\" : \"light\"),\n                          attrs: { type: \"button\" },\n                          on: {\n                            click: function($event) {\n                              $event.preventDefault()\n                              _vm.isFormVisible = !_vm.isFormVisible\n                            }\n                          }\n                        },\n                        [\n                          _c(\"i\", { staticClass: \"fas fa-tag mr-1\" }),\n                          _vm._v(\n                            \"\\n          \" +\n                              _vm._s(_vm.i19addDiscountCoupon) +\n                              \"\\n        \"\n                          )\n                        ]\n                      )\n                    ])\n                  : _c(\n                      \"form\",\n                      {\n                        key: \"form\",\n                        staticClass: \"discount-applier__form\",\n                        on: {\n                          submit: function($event) {\n                            $event.preventDefault()\n                            return _vm.submitCoupon($event)\n                          }\n                        }\n                      },\n                      [\n                        _c(\"div\", { staticClass: \"form-group\" }, [\n                          _c(\n                            \"label\",\n                            { attrs: { for: \"discount-applier-coupon\" } },\n                            [\n                              _vm._v(\n                                \"\\n            \" +\n                                  _vm._s(_vm.i19discountCoupon) +\n                                  \"\\n          \"\n                              )\n                            ]\n                          ),\n                          _vm._v(\" \"),\n                          _c(\"div\", { staticClass: \"input-group\" }, [\n                            _c(\"input\", {\n                              directives: [\n                                {\n                                  name: \"model\",\n                                  rawName: \"v-model\",\n                                  value: _vm.localCouponCode,\n                                  expression: \"localCouponCode\"\n                                }\n                              ],\n                              ref: \"input\",\n                              staticClass:\n                                \"form-control discount-applier__input\",\n                              attrs: {\n                                type: \"text\",\n                                id: \"discount-applier-coupon\",\n                                required: \"\",\n                                readonly: _vm.isLoading,\n                                placeholder: _vm.i19code,\n                                \"aria-label\": _vm.i19code\n                              },\n                              domProps: { value: _vm.localCouponCode },\n                              on: {\n                                input: function($event) {\n                                  if ($event.target.composing) {\n                                    return\n                                  }\n                                  _vm.localCouponCode = $event.target.value\n                                }\n                              }\n                            }),\n                            _vm._v(\" \"),\n                            _c(\"div\", { staticClass: \"input-group-append\" }, [\n                              _vm.isLoading\n                                ? _c(\n                                    \"span\",\n                                    { staticClass: \"input-group-text\" },\n                                    [\n                                      _c(\"span\", {\n                                        staticClass:\n                                          \"spinner-grow spinner-grow-sm\",\n                                        attrs: { role: \"status\" }\n                                      }),\n                                      _vm._v(\" \"),\n                                      _c(\"span\", { staticClass: \"sr-only\" }, [\n                                        _vm._v(\"Loading...\")\n                                      ])\n                                    ]\n                                  )\n                                : _vm.canAddCoupon\n                                ? _c(\n                                    \"button\",\n                                    {\n                                      key: \"add\",\n                                      staticClass: \"btn btn-outline-secondary\",\n                                      attrs: { type: \"submit\" }\n                                    },\n                                    [\n                                      _vm._v(\n                                        \"\\n                \" +\n                                          _vm._s(_vm.i19add) +\n                                          \"\\n              \"\n                                      )\n                                    ]\n                                  )\n                                : _c(\n                                    \"button\",\n                                    {\n                                      key: \"applied\",\n                                      staticClass: \"btn btn-outline-success\",\n                                      attrs: { disabled: \"\", type: \"button\" }\n                                    },\n                                    [\n                                      _c(\"i\", {\n                                        staticClass: \"fas fa-check-circle\"\n                                      })\n                                    ]\n                                  )\n                            ])\n                          ])\n                        ])\n                      ]\n                    )\n              ]\n            )\n          ]\n        : _vm._e(),\n      _vm._v(\" \"),\n      _c(\n        \"a-alert\",\n        {\n          key: \"alert-\" + _vm.alertVariant,\n          attrs: {\n            \"can-show\": !_vm.isLoading && Boolean(_vm.alertText),\n            variant: _vm.alertVariant\n          },\n          on: {\n            dismiss: function($event) {\n              _vm.alertText = null\n            }\n          }\n        },\n        [_vm._v(\"\\n    \" + _vm._s(_vm.alertText) + \"\\n  \")]\n      )\n    ],\n    2\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"section\",\n    { staticClass: \"recommended-items\" },\n    [\n      _c(\"transition\", { attrs: { \"enter-active-class\": \"animated fadeIn\" } }, [\n        _vm.items.length\n          ? _c(\"div\", [\n              _c(\n                \"div\",\n                { staticClass: \"recommended-items__title\" },\n                [\n                  _vm._t(\"title\", [\n                    _c(\"p\", { staticClass: \"lead\" }, [\n                      _vm._v(\n                        \"\\n            \" +\n                          _vm._s(_vm.i19weRecommendToYou) +\n                          \"\\n          \"\n                      )\n                    ])\n                  ])\n                ],\n                2\n              ),\n              _vm._v(\" \"),\n              _c(\n                \"div\",\n                { class: _vm.rowClassName },\n                _vm._l(_vm.items, function(item) {\n                  return _c(\n                    \"div\",\n                    { key: item._id, class: _vm.colClassName },\n                    [\n                      _vm._t(\n                        \"item\",\n                        [\n                          _c(\n                            \"product-card\",\n                            _vm._b(\n                              { attrs: { product: item, \"is-loaded\": true } },\n                              \"product-card\",\n                              _vm.productCardProps,\n                              false\n                            )\n                          )\n                        ],\n                        null,\n                        { item: item }\n                      )\n                    ],\n                    2\n                  )\n                }),\n                0\n              ),\n              _vm._v(\" \"),\n              _vm.canLoadMore\n                ? _c(\"div\", { staticClass: \"recommended-items__load-more\" }, [\n                    _vm.totalCount >= _vm.pageSize * (_vm.pageNumber + 1)\n                      ? _c(\n                          \"button\",\n                          {\n                            staticClass: \"btn btn-sm btn-outline-secondary\",\n                            on: {\n                              click: function($event) {\n                                _vm.pageNumber++\n                              }\n                            }\n                          },\n                          [\n                            _c(\"i\", { staticClass: \"fas fa-plus mr-1\" }),\n                            _vm._v(\" \" + _vm._s(_vm.i19seeMore) + \"\\n        \")\n                          ]\n                        )\n                      : _vm._e()\n                  ])\n                : _vm._e()\n            ])\n          : _vm._e()\n      ])\n    ],\n    1\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../css-loader/dist/cjs.js??ref--0-oneOf-0-1!../../../../vue-loader/lib/loaders/stylePostLoader.js!../../../../resolve-url-loader/index.js??ref--0-oneOf-0-2!../../../../postcss-loader/dist/cjs.js??ref--0-oneOf-0-3!../../../../sass-loader/dist/cjs.js??ref--0-oneOf-0-4!./DiscountApplier.scss?vue&type=style&index=0&lang=scss&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"56f46fba\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../css-loader/dist/cjs.js??ref--0-oneOf-0-1!../../../../vue-loader/lib/loaders/stylePostLoader.js!../../../../resolve-url-loader/index.js??ref--0-oneOf-0-2!../../../../postcss-loader/dist/cjs.js??ref--0-oneOf-0-3!../../../../sass-loader/dist/cjs.js??ref--0-oneOf-0-4!./DiscountApplier.scss?vue&type=style&index=0&lang=scss&\", function() {\n     var newContent = require(\"!!../../../../css-loader/dist/cjs.js??ref--0-oneOf-0-1!../../../../vue-loader/lib/loaders/stylePostLoader.js!../../../../resolve-url-loader/index.js??ref--0-oneOf-0-2!../../../../postcss-loader/dist/cjs.js??ref--0-oneOf-0-3!../../../../sass-loader/dist/cjs.js??ref--0-oneOf-0-4!./DiscountApplier.scss?vue&type=style&index=0&lang=scss&\");\n     if(newContent.__esModule) newContent = newContent.default;\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../css-loader/dist/cjs.js??ref--0-oneOf-0-1!../../../../vue-loader/lib/loaders/stylePostLoader.js!../../../../resolve-url-loader/index.js??ref--0-oneOf-0-2!../../../../postcss-loader/dist/cjs.js??ref--0-oneOf-0-3!../../../../sass-loader/dist/cjs.js??ref--0-oneOf-0-4!./RecommendedItems.scss?vue&type=style&index=0&lang=scss&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"6a6dc5d0\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../css-loader/dist/cjs.js??ref--0-oneOf-0-1!../../../../vue-loader/lib/loaders/stylePostLoader.js!../../../../resolve-url-loader/index.js??ref--0-oneOf-0-2!../../../../postcss-loader/dist/cjs.js??ref--0-oneOf-0-3!../../../../sass-loader/dist/cjs.js??ref--0-oneOf-0-4!./RecommendedItems.scss?vue&type=style&index=0&lang=scss&\", function() {\n     var newContent = require(\"!!../../../../css-loader/dist/cjs.js??ref--0-oneOf-0-1!../../../../vue-loader/lib/loaders/stylePostLoader.js!../../../../resolve-url-loader/index.js??ref--0-oneOf-0-2!../../../../postcss-loader/dist/cjs.js??ref--0-oneOf-0-3!../../../../sass-loader/dist/cjs.js??ref--0-oneOf-0-4!./RecommendedItems.scss?vue&type=style&index=0&lang=scss&\");\n     if(newContent.__esModule) newContent = newContent.default;\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}"],"sourceRoot":""}