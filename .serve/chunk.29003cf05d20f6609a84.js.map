{"version":3,"sources":["webpack:///./template/js/lib/fallback-404.js"],"names":["$fallback404","$","length","urlParams","URLSearchParams","window","location","search","url","get","document","cookie","referrerCookie","split","find","row","startsWith","router","EcomRouter","html","renderNotFound","class","i18n","pt_br","en_us","list","then","routes","append","map","path","catch","console","error","route","resource","_id","Vue","render","h","TheProduct","props","productId","resolve","body","SearchEngine","name","vueInstance","$mount","err"],"mappings":"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","file":"chunk.29003cf05d20f6609a84.js","sourcesContent":["import { i18n } from '@ecomplus/utils'\nimport EcomRouter from '@ecomplus/storefront-router'\nimport { $ } from '@ecomplus/storefront-twbs'\nimport Vue from 'vue'\nimport TheProduct from '#components/TheProduct.vue'\nimport SearchEngine from '#components/SearchEngine.vue'\n\nconst $fallback404 = $('#fallback-404')\nif ($fallback404.length) {\n  const urlParams = new URLSearchParams(window.location.search)\n  let url = urlParams.get('url')\n  if (!url && document.cookie) {\n    const referrerCookie = document.cookie\n      .split('; ')\n      .find(row => row.startsWith('referrerUrl='))\n    if (referrerCookie) {\n      url = referrerCookie.split('=')[1]\n    }\n  }\n\n  if (url) {\n    const router = new EcomRouter()\n    $fallback404.html('<div class=\"spinner-border\" role=\"status\"></div>')\n\n    const renderNotFound = () => {\n      $fallback404.html($('<h3>', {\n        class: 'my-4',\n        html: [\n          '<i class=\"text-muted i-exclamation-triangle mr-3\"></i>',\n          i18n({\n            pt_br: 'Página não encontrada',\n            en_us: 'Page not found'\n          })\n        ]\n      }))\n\n      router.list()\n        .then(routes => {\n          $fallback404.append([\n            $('<p>', {\n              class: 'lead',\n              html: i18n({\n                pt_br: 'Mapa do site:',\n                en_us: 'Sitemap:'\n              })\n            }),\n            $('<ul>', {\n              html: routes.map(({ path }) => {\n                return `<li><a href=\"${path}\">${path}</a></li>`\n              })\n            })\n          ])\n        })\n        .catch(console.error)\n    }\n\n    router.map(url)\n      .then(route => {\n        const { resource, _id } = route\n        switch (resource) {\n          case 'products':\n            return new Vue({\n              render: h => h(TheProduct, {\n                props: {\n                  productId: _id\n                }\n              })\n            })\n\n          case 'brands':\n          case 'categories':\n            return router.resolve(route)\n              .then(({ body }) => {\n                return new Vue({\n                  render: h => h(SearchEngine, {\n                    props: {\n                      [resource]: [body.name]\n                    }\n                  })\n                })\n              })\n        }\n      })\n\n      .then(vueInstance => {\n        if (vueInstance) {\n          vueInstance.$mount($fallback404[0])\n        } else {\n          renderNotFound()\n        }\n      })\n\n      .catch(err => {\n        console.error(err)\n        renderNotFound()\n      })\n  }\n}\n"],"sourceRoot":""}